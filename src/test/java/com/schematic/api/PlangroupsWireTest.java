package com.schematic.api;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.schematic.api.core.ObjectMappers;
import com.schematic.api.resources.plangroups.requests.CreatePlanGroupRequestBody;
import com.schematic.api.resources.plangroups.requests.UpdatePlanGroupRequestBody;
import com.schematic.api.resources.plangroups.types.CreatePlanGroupResponse;
import com.schematic.api.resources.plangroups.types.GetPlanGroupResponse;
import com.schematic.api.resources.plangroups.types.UpdatePlanGroupResponse;
import com.schematic.api.types.OrderedPlansInGroup;
import com.schematic.api.types.PlanGroupBundleOrder;
import java.util.Arrays;
import okhttp3.mockwebserver.MockResponse;
import okhttp3.mockwebserver.MockWebServer;
import okhttp3.mockwebserver.RecordedRequest;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

public class PlangroupsWireTest {
    private MockWebServer server;
    private BaseSchematic client;
    private ObjectMapper objectMapper = ObjectMappers.JSON_MAPPER;

    @BeforeEach
    public void setup() throws Exception {
        server = new MockWebServer();
        server.start();
        client = BaseSchematic.builder()
                .url(server.url("/").toString())
                .apiKey("test-api-key")
                .build();
    }

    @AfterEach
    public void teardown() throws Exception {
        server.shutdown();
    }

    @Test
    public void testGetPlanGroup() throws Exception {
        server.enqueue(
                new MockResponse()
                        .setResponseCode(200)
                        .setBody(
                                "{\"data\":{\"add_ons\":[{\"charge_type\":\"charge_type\",\"company_count\":1,\"compatible_plan_ids\":[\"compatible_plan_ids\"],\"controlled_by\":\"controlled_by\",\"created_at\":\"2024-01-15T09:30:00Z\",\"description\":\"description\",\"entitlements\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"feature_id\":\"feature_id\",\"id\":\"id\",\"plan_id\":\"plan_id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value_type\":\"value_type\"}],\"features\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"description\":\"description\",\"feature_type\":\"feature_type\",\"flags\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"default_value\":true,\"description\":\"description\",\"flag_type\":\"flag_type\",\"id\":\"id\",\"key\":\"key\",\"name\":\"name\",\"rules\":[{\"condition_groups\":[{\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"name\":\"name\",\"priority\":1,\"rule_type\":\"rule_type\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value\":true}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"name\":\"name\",\"plans\":[{\"id\":\"id\",\"name\":\"name\"}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"is_custom\":true,\"is_default\":true,\"is_free\":true,\"is_trialable\":true,\"name\":\"name\",\"plan_type\":\"plan_type\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"checkout_settings\":{\"collect_address\":true,\"collect_email\":true,\"collect_phone\":true},\"custom_plan_config\":{\"cta_text\":\"cta_text\",\"cta_web_site\":\"cta_web_site\",\"price_text\":\"price_text\"},\"custom_plan_id\":\"custom_plan_id\",\"default_plan\":{\"billing_product\":{\"account_id\":\"account_id\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"external_id\":\"external_id\",\"is_active\":true,\"name\":\"name\",\"price\":1.1,\"prices\":[{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"}],\"product_id\":\"product_id\",\"quantity\":1.1,\"subscription_count\":1,\"updated_at\":\"2024-01-15T09:30:00Z\"},\"charge_type\":\"charge_type\",\"company_count\":1,\"compatible_plan_ids\":[\"compatible_plan_ids\"],\"controlled_by\":\"controlled_by\",\"created_at\":\"2024-01-15T09:30:00Z\",\"custom_plan_config\":{\"cta_text\":\"cta_text\",\"cta_web_site\":\"cta_web_site\",\"price_text\":\"price_text\"},\"description\":\"description\",\"entitlements\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"feature_id\":\"feature_id\",\"id\":\"id\",\"plan_id\":\"plan_id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value_type\":\"value_type\"}],\"features\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"description\":\"description\",\"feature_type\":\"feature_type\",\"flags\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"default_value\":true,\"description\":\"description\",\"flag_type\":\"flag_type\",\"id\":\"id\",\"key\":\"key\",\"name\":\"name\",\"rules\":[{\"condition_groups\":[{\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"name\":\"name\",\"priority\":1,\"rule_type\":\"rule_type\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value\":true}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"name\":\"name\",\"plans\":[{\"id\":\"id\",\"name\":\"name\"}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"included_credit_grants\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"credit_amount\":1,\"credit_id\":\"credit_id\",\"credit_name\":\"credit_name\",\"id\":\"id\",\"plan_id\":\"plan_id\",\"plan_name\":\"plan_name\",\"reset_cadence\":\"reset_cadence\",\"reset_start\":\"reset_start\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"is_custom\":true,\"is_default\":true,\"is_free\":true,\"is_trialable\":true,\"monthly_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"},\"name\":\"name\",\"one_time_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"},\"plan_type\":\"plan_type\",\"trial_days\":1,\"updated_at\":\"2024-01-15T09:30:00Z\",\"yearly_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"}},\"fallback_plan\":{\"billing_product\":{\"account_id\":\"account_id\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"external_id\":\"external_id\",\"is_active\":true,\"name\":\"name\",\"price\":1.1,\"prices\":[{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"}],\"product_id\":\"product_id\",\"quantity\":1.1,\"subscription_count\":1,\"updated_at\":\"2024-01-15T09:30:00Z\"},\"charge_type\":\"charge_type\",\"company_count\":1,\"compatible_plan_ids\":[\"compatible_plan_ids\"],\"controlled_by\":\"controlled_by\",\"created_at\":\"2024-01-15T09:30:00Z\",\"custom_plan_config\":{\"cta_text\":\"cta_text\",\"cta_web_site\":\"cta_web_site\",\"price_text\":\"price_text\"},\"description\":\"description\",\"entitlements\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"feature_id\":\"feature_id\",\"id\":\"id\",\"plan_id\":\"plan_id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value_type\":\"value_type\"}],\"features\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"description\":\"description\",\"feature_type\":\"feature_type\",\"flags\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"default_value\":true,\"description\":\"description\",\"flag_type\":\"flag_type\",\"id\":\"id\",\"key\":\"key\",\"name\":\"name\",\"rules\":[{\"condition_groups\":[{\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"name\":\"name\",\"priority\":1,\"rule_type\":\"rule_type\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value\":true}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"name\":\"name\",\"plans\":[{\"id\":\"id\",\"name\":\"name\"}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"included_credit_grants\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"credit_amount\":1,\"credit_id\":\"credit_id\",\"credit_name\":\"credit_name\",\"id\":\"id\",\"plan_id\":\"plan_id\",\"plan_name\":\"plan_name\",\"reset_cadence\":\"reset_cadence\",\"reset_start\":\"reset_start\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"is_custom\":true,\"is_default\":true,\"is_free\":true,\"is_trialable\":true,\"monthly_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"},\"name\":\"name\",\"one_time_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"},\"plan_type\":\"plan_type\",\"trial_days\":1,\"updated_at\":\"2024-01-15T09:30:00Z\",\"yearly_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"}},\"fallback_plan_id\":\"fallback_plan_id\",\"id\":\"id\",\"initial_plan\":{\"billing_product\":{\"account_id\":\"account_id\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"external_id\":\"external_id\",\"is_active\":true,\"name\":\"name\",\"price\":1.1,\"prices\":[{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"}],\"product_id\":\"product_id\",\"quantity\":1.1,\"subscription_count\":1,\"updated_at\":\"2024-01-15T09:30:00Z\"},\"charge_type\":\"charge_type\",\"company_count\":1,\"compatible_plan_ids\":[\"compatible_plan_ids\"],\"controlled_by\":\"controlled_by\",\"created_at\":\"2024-01-15T09:30:00Z\",\"custom_plan_config\":{\"cta_text\":\"cta_text\",\"cta_web_site\":\"cta_web_site\",\"price_text\":\"price_text\"},\"description\":\"description\",\"entitlements\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"feature_id\":\"feature_id\",\"id\":\"id\",\"plan_id\":\"plan_id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value_type\":\"value_type\"}],\"features\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"description\":\"description\",\"feature_type\":\"feature_type\",\"flags\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"default_value\":true,\"description\":\"description\",\"flag_type\":\"flag_type\",\"id\":\"id\",\"key\":\"key\",\"name\":\"name\",\"rules\":[{\"condition_groups\":[{\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"name\":\"name\",\"priority\":1,\"rule_type\":\"rule_type\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value\":true}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"name\":\"name\",\"plans\":[{\"id\":\"id\",\"name\":\"name\"}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"included_credit_grants\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"credit_amount\":1,\"credit_id\":\"credit_id\",\"credit_name\":\"credit_name\",\"id\":\"id\",\"plan_id\":\"plan_id\",\"plan_name\":\"plan_name\",\"reset_cadence\":\"reset_cadence\",\"reset_start\":\"reset_start\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"is_custom\":true,\"is_default\":true,\"is_free\":true,\"is_trialable\":true,\"monthly_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"},\"name\":\"name\",\"one_time_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"},\"plan_type\":\"plan_type\",\"trial_days\":1,\"updated_at\":\"2024-01-15T09:30:00Z\",\"yearly_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"}},\"initial_plan_id\":\"initial_plan_id\",\"initial_plan_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"price_decimal\":\"price_decimal\",\"scheme\":\"scheme\"},\"initial_plan_price_id\":\"initial_plan_price_id\",\"ordered_add_on_list\":[{\"plan_id\":\"plan_id\"}],\"ordered_bundle_list\":[{\"bundleId\":\"bundleId\"}],\"ordered_plan_list\":[{\"plan_id\":\"plan_id\"}],\"plans\":[{\"charge_type\":\"charge_type\",\"company_count\":1,\"compatible_plan_ids\":[\"compatible_plan_ids\"],\"controlled_by\":\"controlled_by\",\"created_at\":\"2024-01-15T09:30:00Z\",\"description\":\"description\",\"entitlements\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"feature_id\":\"feature_id\",\"id\":\"id\",\"plan_id\":\"plan_id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value_type\":\"value_type\"}],\"features\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"description\":\"description\",\"feature_type\":\"feature_type\",\"flags\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"default_value\":true,\"description\":\"description\",\"flag_type\":\"flag_type\",\"id\":\"id\",\"key\":\"key\",\"name\":\"name\",\"rules\":[{\"condition_groups\":[{\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"name\":\"name\",\"priority\":1,\"rule_type\":\"rule_type\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value\":true}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"name\":\"name\",\"plans\":[{\"id\":\"id\",\"name\":\"name\"}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"is_custom\":true,\"is_default\":true,\"is_free\":true,\"is_trialable\":true,\"name\":\"name\",\"plan_type\":\"plan_type\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"prevent_downgrades_when_over_limit\":true,\"show_credits\":true,\"show_period_toggle\":true,\"show_zero_price_as_free\":true,\"sync_customer_billing_details_for_tax\":true,\"tax_collection_enabled\":true,\"trial_days\":1,\"trial_expiry_plan\":{\"billing_product\":{\"account_id\":\"account_id\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"external_id\":\"external_id\",\"is_active\":true,\"name\":\"name\",\"price\":1.1,\"prices\":[{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"}],\"product_id\":\"product_id\",\"quantity\":1.1,\"subscription_count\":1,\"updated_at\":\"2024-01-15T09:30:00Z\"},\"charge_type\":\"charge_type\",\"company_count\":1,\"compatible_plan_ids\":[\"compatible_plan_ids\"],\"controlled_by\":\"controlled_by\",\"created_at\":\"2024-01-15T09:30:00Z\",\"custom_plan_config\":{\"cta_text\":\"cta_text\",\"cta_web_site\":\"cta_web_site\",\"price_text\":\"price_text\"},\"description\":\"description\",\"entitlements\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"feature_id\":\"feature_id\",\"id\":\"id\",\"plan_id\":\"plan_id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value_type\":\"value_type\"}],\"features\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"description\":\"description\",\"feature_type\":\"feature_type\",\"flags\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"default_value\":true,\"description\":\"description\",\"flag_type\":\"flag_type\",\"id\":\"id\",\"key\":\"key\",\"name\":\"name\",\"rules\":[{\"condition_groups\":[{\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"rule_id\":\"rule_id\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"conditions\":[{\"condition_type\":\"condition_type\",\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"operator\":\"operator\",\"resource_ids\":[\"resource_ids\"],\"resources\":[{\"id\":\"id\",\"name\":\"name\"}],\"rule_id\":\"rule_id\",\"trait_value\":\"trait_value\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"created_at\":\"2024-01-15T09:30:00Z\",\"environment_id\":\"environment_id\",\"id\":\"id\",\"name\":\"name\",\"priority\":1,\"rule_type\":\"rule_type\",\"updated_at\":\"2024-01-15T09:30:00Z\",\"value\":true}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"name\":\"name\",\"plans\":[{\"id\":\"id\",\"name\":\"name\"}],\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"icon\":\"icon\",\"id\":\"id\",\"included_credit_grants\":[{\"created_at\":\"2024-01-15T09:30:00Z\",\"credit_amount\":1,\"credit_id\":\"credit_id\",\"credit_name\":\"credit_name\",\"id\":\"id\",\"plan_id\":\"plan_id\",\"plan_name\":\"plan_name\",\"reset_cadence\":\"reset_cadence\",\"reset_start\":\"reset_start\",\"updated_at\":\"2024-01-15T09:30:00Z\"}],\"is_custom\":true,\"is_default\":true,\"is_free\":true,\"is_trialable\":true,\"monthly_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"},\"name\":\"name\",\"one_time_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"},\"plan_type\":\"plan_type\",\"trial_days\":1,\"updated_at\":\"2024-01-15T09:30:00Z\",\"yearly_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"scheme\":\"scheme\"}},\"trial_expiry_plan_id\":\"trial_expiry_plan_id\",\"trial_expiry_plan_price\":{\"currency\":\"currency\",\"external_price_id\":\"external_price_id\",\"id\":\"id\",\"interval\":\"interval\",\"price\":1,\"price_decimal\":\"price_decimal\",\"scheme\":\"scheme\"},\"trial_expiry_plan_price_id\":\"trial_expiry_plan_price_id\",\"trial_payment_method_required\":true},\"params\":{\"key\":\"value\"}}"));
        GetPlanGroupResponse response = client.plangroups().getPlanGroup();
        RecordedRequest request = server.takeRequest();
        Assertions.assertNotNull(request);
        Assertions.assertEquals("GET", request.getMethod());

        // Validate response body
        Assertions.assertNotNull(response, "Response should not be null");
        String actualResponseJson = objectMapper.writeValueAsString(response);
        String expectedResponseBody = ""
                + "{\n"
                + "  \"data\": {\n"
                + "    \"add_ons\": [\n"
                + "      {\n"
                + "        \"charge_type\": \"charge_type\",\n"
                + "        \"company_count\": 1,\n"
                + "        \"compatible_plan_ids\": [\n"
                + "          \"compatible_plan_ids\"\n"
                + "        ],\n"
                + "        \"controlled_by\": \"controlled_by\",\n"
                + "        \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "        \"description\": \"description\",\n"
                + "        \"entitlements\": [\n"
                + "          {\n"
                + "            \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "            \"environment_id\": \"environment_id\",\n"
                + "            \"feature_id\": \"feature_id\",\n"
                + "            \"id\": \"id\",\n"
                + "            \"plan_id\": \"plan_id\",\n"
                + "            \"rule_id\": \"rule_id\",\n"
                + "            \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "            \"value_type\": \"value_type\"\n"
                + "          }\n"
                + "        ],\n"
                + "        \"features\": [\n"
                + "          {\n"
                + "            \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "            \"description\": \"description\",\n"
                + "            \"feature_type\": \"feature_type\",\n"
                + "            \"flags\": [\n"
                + "              {\n"
                + "                \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                \"default_value\": true,\n"
                + "                \"description\": \"description\",\n"
                + "                \"flag_type\": \"flag_type\",\n"
                + "                \"id\": \"id\",\n"
                + "                \"key\": \"key\",\n"
                + "                \"name\": \"name\",\n"
                + "                \"rules\": [\n"
                + "                  {\n"
                + "                    \"condition_groups\": [\n"
                + "                      {\n"
                + "                        \"conditions\": [\n"
                + "                          {\n"
                + "                            \"condition_type\": \"condition_type\",\n"
                + "                            \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                            \"environment_id\": \"environment_id\",\n"
                + "                            \"id\": \"id\",\n"
                + "                            \"operator\": \"operator\",\n"
                + "                            \"resource_ids\": [\n"
                + "                              \"resource_ids\"\n"
                + "                            ],\n"
                + "                            \"resources\": [\n"
                + "                              {\n"
                + "                                \"id\": \"id\",\n"
                + "                                \"name\": \"name\"\n"
                + "                              }\n"
                + "                            ],\n"
                + "                            \"rule_id\": \"rule_id\",\n"
                + "                            \"trait_value\": \"trait_value\",\n"
                + "                            \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                          }\n"
                + "                        ],\n"
                + "                        \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                        \"environment_id\": \"environment_id\",\n"
                + "                        \"id\": \"id\",\n"
                + "                        \"rule_id\": \"rule_id\",\n"
                + "                        \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                      }\n"
                + "                    ],\n"
                + "                    \"conditions\": [\n"
                + "                      {\n"
                + "                        \"condition_type\": \"condition_type\",\n"
                + "                        \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                        \"environment_id\": \"environment_id\",\n"
                + "                        \"id\": \"id\",\n"
                + "                        \"operator\": \"operator\",\n"
                + "                        \"resource_ids\": [\n"
                + "                          \"resource_ids\"\n"
                + "                        ],\n"
                + "                        \"resources\": [\n"
                + "                          {\n"
                + "                            \"id\": \"id\",\n"
                + "                            \"name\": \"name\"\n"
                + "                          }\n"
                + "                        ],\n"
                + "                        \"rule_id\": \"rule_id\",\n"
                + "                        \"trait_value\": \"trait_value\",\n"
                + "                        \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                      }\n"
                + "                    ],\n"
                + "                    \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                    \"environment_id\": \"environment_id\",\n"
                + "                    \"id\": \"id\",\n"
                + "                    \"name\": \"name\",\n"
                + "                    \"priority\": 1,\n"
                + "                    \"rule_type\": \"rule_type\",\n"
                + "                    \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                    \"value\": true\n"
                + "                  }\n"
                + "                ],\n"
                + "                \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "              }\n"
                + "            ],\n"
                + "            \"icon\": \"icon\",\n"
                + "            \"id\": \"id\",\n"
                + "            \"name\": \"name\",\n"
                + "            \"plans\": [\n"
                + "              {\n"
                + "                \"id\": \"id\",\n"
                + "                \"name\": \"name\"\n"
                + "              }\n"
                + "            ],\n"
                + "            \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "          }\n"
                + "        ],\n"
                + "        \"icon\": \"icon\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"is_custom\": true,\n"
                + "        \"is_default\": true,\n"
                + "        \"is_free\": true,\n"
                + "        \"is_trialable\": true,\n"
                + "        \"name\": \"name\",\n"
                + "        \"plan_type\": \"plan_type\",\n"
                + "        \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "      }\n"
                + "    ],\n"
                + "    \"checkout_settings\": {\n"
                + "      \"collect_address\": true,\n"
                + "      \"collect_email\": true,\n"
                + "      \"collect_phone\": true\n"
                + "    },\n"
                + "    \"custom_plan_config\": {\n"
                + "      \"cta_text\": \"cta_text\",\n"
                + "      \"cta_web_site\": \"cta_web_site\",\n"
                + "      \"price_text\": \"price_text\"\n"
                + "    },\n"
                + "    \"custom_plan_id\": \"custom_plan_id\",\n"
                + "    \"default_plan\": {\n"
                + "      \"billing_product\": {\n"
                + "        \"account_id\": \"account_id\",\n"
                + "        \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "        \"environment_id\": \"environment_id\",\n"
                + "        \"external_id\": \"external_id\",\n"
                + "        \"is_active\": true,\n"
                + "        \"name\": \"name\",\n"
                + "        \"price\": 1.1,\n"
                + "        \"prices\": [\n"
                + "          {\n"
                + "            \"currency\": \"currency\",\n"
                + "            \"external_price_id\": \"external_price_id\",\n"
                + "            \"id\": \"id\",\n"
                + "            \"interval\": \"interval\",\n"
                + "            \"price\": 1,\n"
                + "            \"scheme\": \"scheme\"\n"
                + "          }\n"
                + "        ],\n"
                + "        \"product_id\": \"product_id\",\n"
                + "        \"quantity\": 1.1,\n"
                + "        \"subscription_count\": 1,\n"
                + "        \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "      },\n"
                + "      \"charge_type\": \"charge_type\",\n"
                + "      \"company_count\": 1,\n"
                + "      \"compatible_plan_ids\": [\n"
                + "        \"compatible_plan_ids\"\n"
                + "      ],\n"
                + "      \"controlled_by\": \"controlled_by\",\n"
                + "      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "      \"custom_plan_config\": {\n"
                + "        \"cta_text\": \"cta_text\",\n"
                + "        \"cta_web_site\": \"cta_web_site\",\n"
                + "        \"price_text\": \"price_text\"\n"
                + "      },\n"
                + "      \"description\": \"description\",\n"
                + "      \"entitlements\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"environment_id\": \"environment_id\",\n"
                + "          \"feature_id\": \"feature_id\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"plan_id\": \"plan_id\",\n"
                + "          \"rule_id\": \"rule_id\",\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"value_type\": \"value_type\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"features\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"description\": \"description\",\n"
                + "          \"feature_type\": \"feature_type\",\n"
                + "          \"flags\": [\n"
                + "            {\n"
                + "              \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "              \"default_value\": true,\n"
                + "              \"description\": \"description\",\n"
                + "              \"flag_type\": \"flag_type\",\n"
                + "              \"id\": \"id\",\n"
                + "              \"key\": \"key\",\n"
                + "              \"name\": \"name\",\n"
                + "              \"rules\": [\n"
                + "                {\n"
                + "                  \"condition_groups\": [\n"
                + "                    {\n"
                + "                      \"conditions\": [\n"
                + "                        {\n"
                + "                          \"condition_type\": \"condition_type\",\n"
                + "                          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                          \"environment_id\": \"environment_id\",\n"
                + "                          \"id\": \"id\",\n"
                + "                          \"operator\": \"operator\",\n"
                + "                          \"resource_ids\": [\n"
                + "                            \"resource_ids\"\n"
                + "                          ],\n"
                + "                          \"resources\": [\n"
                + "                            {\n"
                + "                              \"id\": \"id\",\n"
                + "                              \"name\": \"name\"\n"
                + "                            }\n"
                + "                          ],\n"
                + "                          \"rule_id\": \"rule_id\",\n"
                + "                          \"trait_value\": \"trait_value\",\n"
                + "                          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                        }\n"
                + "                      ],\n"
                + "                      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                      \"environment_id\": \"environment_id\",\n"
                + "                      \"id\": \"id\",\n"
                + "                      \"rule_id\": \"rule_id\",\n"
                + "                      \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                    }\n"
                + "                  ],\n"
                + "                  \"conditions\": [\n"
                + "                    {\n"
                + "                      \"condition_type\": \"condition_type\",\n"
                + "                      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                      \"environment_id\": \"environment_id\",\n"
                + "                      \"id\": \"id\",\n"
                + "                      \"operator\": \"operator\",\n"
                + "                      \"resource_ids\": [\n"
                + "                        \"resource_ids\"\n"
                + "                      ],\n"
                + "                      \"resources\": [\n"
                + "                        {\n"
                + "                          \"id\": \"id\",\n"
                + "                          \"name\": \"name\"\n"
                + "                        }\n"
                + "                      ],\n"
                + "                      \"rule_id\": \"rule_id\",\n"
                + "                      \"trait_value\": \"trait_value\",\n"
                + "                      \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                    }\n"
                + "                  ],\n"
                + "                  \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                  \"environment_id\": \"environment_id\",\n"
                + "                  \"id\": \"id\",\n"
                + "                  \"name\": \"name\",\n"
                + "                  \"priority\": 1,\n"
                + "                  \"rule_type\": \"rule_type\",\n"
                + "                  \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                  \"value\": true\n"
                + "                }\n"
                + "              ],\n"
                + "              \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "            }\n"
                + "          ],\n"
                + "          \"icon\": \"icon\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"name\": \"name\",\n"
                + "          \"plans\": [\n"
                + "            {\n"
                + "              \"id\": \"id\",\n"
                + "              \"name\": \"name\"\n"
                + "            }\n"
                + "          ],\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"icon\": \"icon\",\n"
                + "      \"id\": \"id\",\n"
                + "      \"included_credit_grants\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"credit_amount\": 1,\n"
                + "          \"credit_id\": \"credit_id\",\n"
                + "          \"credit_name\": \"credit_name\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"plan_id\": \"plan_id\",\n"
                + "          \"plan_name\": \"plan_name\",\n"
                + "          \"reset_cadence\": \"reset_cadence\",\n"
                + "          \"reset_start\": \"reset_start\",\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"is_custom\": true,\n"
                + "      \"is_default\": true,\n"
                + "      \"is_free\": true,\n"
                + "      \"is_trialable\": true,\n"
                + "      \"monthly_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      },\n"
                + "      \"name\": \"name\",\n"
                + "      \"one_time_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      },\n"
                + "      \"plan_type\": \"plan_type\",\n"
                + "      \"trial_days\": 1,\n"
                + "      \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "      \"yearly_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      }\n"
                + "    },\n"
                + "    \"fallback_plan\": {\n"
                + "      \"billing_product\": {\n"
                + "        \"account_id\": \"account_id\",\n"
                + "        \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "        \"environment_id\": \"environment_id\",\n"
                + "        \"external_id\": \"external_id\",\n"
                + "        \"is_active\": true,\n"
                + "        \"name\": \"name\",\n"
                + "        \"price\": 1.1,\n"
                + "        \"prices\": [\n"
                + "          {\n"
                + "            \"currency\": \"currency\",\n"
                + "            \"external_price_id\": \"external_price_id\",\n"
                + "            \"id\": \"id\",\n"
                + "            \"interval\": \"interval\",\n"
                + "            \"price\": 1,\n"
                + "            \"scheme\": \"scheme\"\n"
                + "          }\n"
                + "        ],\n"
                + "        \"product_id\": \"product_id\",\n"
                + "        \"quantity\": 1.1,\n"
                + "        \"subscription_count\": 1,\n"
                + "        \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "      },\n"
                + "      \"charge_type\": \"charge_type\",\n"
                + "      \"company_count\": 1,\n"
                + "      \"compatible_plan_ids\": [\n"
                + "        \"compatible_plan_ids\"\n"
                + "      ],\n"
                + "      \"controlled_by\": \"controlled_by\",\n"
                + "      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "      \"custom_plan_config\": {\n"
                + "        \"cta_text\": \"cta_text\",\n"
                + "        \"cta_web_site\": \"cta_web_site\",\n"
                + "        \"price_text\": \"price_text\"\n"
                + "      },\n"
                + "      \"description\": \"description\",\n"
                + "      \"entitlements\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"environment_id\": \"environment_id\",\n"
                + "          \"feature_id\": \"feature_id\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"plan_id\": \"plan_id\",\n"
                + "          \"rule_id\": \"rule_id\",\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"value_type\": \"value_type\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"features\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"description\": \"description\",\n"
                + "          \"feature_type\": \"feature_type\",\n"
                + "          \"flags\": [\n"
                + "            {\n"
                + "              \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "              \"default_value\": true,\n"
                + "              \"description\": \"description\",\n"
                + "              \"flag_type\": \"flag_type\",\n"
                + "              \"id\": \"id\",\n"
                + "              \"key\": \"key\",\n"
                + "              \"name\": \"name\",\n"
                + "              \"rules\": [\n"
                + "                {\n"
                + "                  \"condition_groups\": [\n"
                + "                    {\n"
                + "                      \"conditions\": [\n"
                + "                        {\n"
                + "                          \"condition_type\": \"condition_type\",\n"
                + "                          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                          \"environment_id\": \"environment_id\",\n"
                + "                          \"id\": \"id\",\n"
                + "                          \"operator\": \"operator\",\n"
                + "                          \"resource_ids\": [\n"
                + "                            \"resource_ids\"\n"
                + "                          ],\n"
                + "                          \"resources\": [\n"
                + "                            {\n"
                + "                              \"id\": \"id\",\n"
                + "                              \"name\": \"name\"\n"
                + "                            }\n"
                + "                          ],\n"
                + "                          \"rule_id\": \"rule_id\",\n"
                + "                          \"trait_value\": \"trait_value\",\n"
                + "                          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                        }\n"
                + "                      ],\n"
                + "                      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                      \"environment_id\": \"environment_id\",\n"
                + "                      \"id\": \"id\",\n"
                + "                      \"rule_id\": \"rule_id\",\n"
                + "                      \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                    }\n"
                + "                  ],\n"
                + "                  \"conditions\": [\n"
                + "                    {\n"
                + "                      \"condition_type\": \"condition_type\",\n"
                + "                      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                      \"environment_id\": \"environment_id\",\n"
                + "                      \"id\": \"id\",\n"
                + "                      \"operator\": \"operator\",\n"
                + "                      \"resource_ids\": [\n"
                + "                        \"resource_ids\"\n"
                + "                      ],\n"
                + "                      \"resources\": [\n"
                + "                        {\n"
                + "                          \"id\": \"id\",\n"
                + "                          \"name\": \"name\"\n"
                + "                        }\n"
                + "                      ],\n"
                + "                      \"rule_id\": \"rule_id\",\n"
                + "                      \"trait_value\": \"trait_value\",\n"
                + "                      \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                    }\n"
                + "                  ],\n"
                + "                  \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                  \"environment_id\": \"environment_id\",\n"
                + "                  \"id\": \"id\",\n"
                + "                  \"name\": \"name\",\n"
                + "                  \"priority\": 1,\n"
                + "                  \"rule_type\": \"rule_type\",\n"
                + "                  \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                  \"value\": true\n"
                + "                }\n"
                + "              ],\n"
                + "              \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "            }\n"
                + "          ],\n"
                + "          \"icon\": \"icon\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"name\": \"name\",\n"
                + "          \"plans\": [\n"
                + "            {\n"
                + "              \"id\": \"id\",\n"
                + "              \"name\": \"name\"\n"
                + "            }\n"
                + "          ],\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"icon\": \"icon\",\n"
                + "      \"id\": \"id\",\n"
                + "      \"included_credit_grants\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"credit_amount\": 1,\n"
                + "          \"credit_id\": \"credit_id\",\n"
                + "          \"credit_name\": \"credit_name\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"plan_id\": \"plan_id\",\n"
                + "          \"plan_name\": \"plan_name\",\n"
                + "          \"reset_cadence\": \"reset_cadence\",\n"
                + "          \"reset_start\": \"reset_start\",\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"is_custom\": true,\n"
                + "      \"is_default\": true,\n"
                + "      \"is_free\": true,\n"
                + "      \"is_trialable\": true,\n"
                + "      \"monthly_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      },\n"
                + "      \"name\": \"name\",\n"
                + "      \"one_time_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      },\n"
                + "      \"plan_type\": \"plan_type\",\n"
                + "      \"trial_days\": 1,\n"
                + "      \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "      \"yearly_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      }\n"
                + "    },\n"
                + "    \"fallback_plan_id\": \"fallback_plan_id\",\n"
                + "    \"id\": \"id\",\n"
                + "    \"initial_plan\": {\n"
                + "      \"billing_product\": {\n"
                + "        \"account_id\": \"account_id\",\n"
                + "        \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "        \"environment_id\": \"environment_id\",\n"
                + "        \"external_id\": \"external_id\",\n"
                + "        \"is_active\": true,\n"
                + "        \"name\": \"name\",\n"
                + "        \"price\": 1.1,\n"
                + "        \"prices\": [\n"
                + "          {\n"
                + "            \"currency\": \"currency\",\n"
                + "            \"external_price_id\": \"external_price_id\",\n"
                + "            \"id\": \"id\",\n"
                + "            \"interval\": \"interval\",\n"
                + "            \"price\": 1,\n"
                + "            \"scheme\": \"scheme\"\n"
                + "          }\n"
                + "        ],\n"
                + "        \"product_id\": \"product_id\",\n"
                + "        \"quantity\": 1.1,\n"
                + "        \"subscription_count\": 1,\n"
                + "        \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "      },\n"
                + "      \"charge_type\": \"charge_type\",\n"
                + "      \"company_count\": 1,\n"
                + "      \"compatible_plan_ids\": [\n"
                + "        \"compatible_plan_ids\"\n"
                + "      ],\n"
                + "      \"controlled_by\": \"controlled_by\",\n"
                + "      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "      \"custom_plan_config\": {\n"
                + "        \"cta_text\": \"cta_text\",\n"
                + "        \"cta_web_site\": \"cta_web_site\",\n"
                + "        \"price_text\": \"price_text\"\n"
                + "      },\n"
                + "      \"description\": \"description\",\n"
                + "      \"entitlements\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"environment_id\": \"environment_id\",\n"
                + "          \"feature_id\": \"feature_id\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"plan_id\": \"plan_id\",\n"
                + "          \"rule_id\": \"rule_id\",\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"value_type\": \"value_type\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"features\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"description\": \"description\",\n"
                + "          \"feature_type\": \"feature_type\",\n"
                + "          \"flags\": [\n"
                + "            {\n"
                + "              \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "              \"default_value\": true,\n"
                + "              \"description\": \"description\",\n"
                + "              \"flag_type\": \"flag_type\",\n"
                + "              \"id\": \"id\",\n"
                + "              \"key\": \"key\",\n"
                + "              \"name\": \"name\",\n"
                + "              \"rules\": [\n"
                + "                {\n"
                + "                  \"condition_groups\": [\n"
                + "                    {\n"
                + "                      \"conditions\": [\n"
                + "                        {\n"
                + "                          \"condition_type\": \"condition_type\",\n"
                + "                          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                          \"environment_id\": \"environment_id\",\n"
                + "                          \"id\": \"id\",\n"
                + "                          \"operator\": \"operator\",\n"
                + "                          \"resource_ids\": [\n"
                + "                            \"resource_ids\"\n"
                + "                          ],\n"
                + "                          \"resources\": [\n"
                + "                            {\n"
                + "                              \"id\": \"id\",\n"
                + "                              \"name\": \"name\"\n"
                + "                            }\n"
                + "                          ],\n"
                + "                          \"rule_id\": \"rule_id\",\n"
                + "                          \"trait_value\": \"trait_value\",\n"
                + "                          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                        }\n"
                + "                      ],\n"
                + "                      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                      \"environment_id\": \"environment_id\",\n"
                + "                      \"id\": \"id\",\n"
                + "                      \"rule_id\": \"rule_id\",\n"
                + "                      \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                    }\n"
                + "                  ],\n"
                + "                  \"conditions\": [\n"
                + "                    {\n"
                + "                      \"condition_type\": \"condition_type\",\n"
                + "                      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                      \"environment_id\": \"environment_id\",\n"
                + "                      \"id\": \"id\",\n"
                + "                      \"operator\": \"operator\",\n"
                + "                      \"resource_ids\": [\n"
                + "                        \"resource_ids\"\n"
                + "                      ],\n"
                + "                      \"resources\": [\n"
                + "                        {\n"
                + "                          \"id\": \"id\",\n"
                + "                          \"name\": \"name\"\n"
                + "                        }\n"
                + "                      ],\n"
                + "                      \"rule_id\": \"rule_id\",\n"
                + "                      \"trait_value\": \"trait_value\",\n"
                + "                      \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                    }\n"
                + "                  ],\n"
                + "                  \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                  \"environment_id\": \"environment_id\",\n"
                + "                  \"id\": \"id\",\n"
                + "                  \"name\": \"name\",\n"
                + "                  \"priority\": 1,\n"
                + "                  \"rule_type\": \"rule_type\",\n"
                + "                  \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                  \"value\": true\n"
                + "                }\n"
                + "              ],\n"
                + "              \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "            }\n"
                + "          ],\n"
                + "          \"icon\": \"icon\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"name\": \"name\",\n"
                + "          \"plans\": [\n"
                + "            {\n"
                + "              \"id\": \"id\",\n"
                + "              \"name\": \"name\"\n"
                + "            }\n"
                + "          ],\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"icon\": \"icon\",\n"
                + "      \"id\": \"id\",\n"
                + "      \"included_credit_grants\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"credit_amount\": 1,\n"
                + "          \"credit_id\": \"credit_id\",\n"
                + "          \"credit_name\": \"credit_name\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"plan_id\": \"plan_id\",\n"
                + "          \"plan_name\": \"plan_name\",\n"
                + "          \"reset_cadence\": \"reset_cadence\",\n"
                + "          \"reset_start\": \"reset_start\",\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"is_custom\": true,\n"
                + "      \"is_default\": true,\n"
                + "      \"is_free\": true,\n"
                + "      \"is_trialable\": true,\n"
                + "      \"monthly_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      },\n"
                + "      \"name\": \"name\",\n"
                + "      \"one_time_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      },\n"
                + "      \"plan_type\": \"plan_type\",\n"
                + "      \"trial_days\": 1,\n"
                + "      \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "      \"yearly_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      }\n"
                + "    },\n"
                + "    \"initial_plan_id\": \"initial_plan_id\",\n"
                + "    \"initial_plan_price\": {\n"
                + "      \"currency\": \"currency\",\n"
                + "      \"external_price_id\": \"external_price_id\",\n"
                + "      \"id\": \"id\",\n"
                + "      \"interval\": \"interval\",\n"
                + "      \"price\": 1,\n"
                + "      \"price_decimal\": \"price_decimal\",\n"
                + "      \"scheme\": \"scheme\"\n"
                + "    },\n"
                + "    \"initial_plan_price_id\": \"initial_plan_price_id\",\n"
                + "    \"ordered_add_on_list\": [\n"
                + "      {\n"
                + "        \"plan_id\": \"plan_id\"\n"
                + "      }\n"
                + "    ],\n"
                + "    \"ordered_bundle_list\": [\n"
                + "      {\n"
                + "        \"bundleId\": \"bundleId\"\n"
                + "      }\n"
                + "    ],\n"
                + "    \"ordered_plan_list\": [\n"
                + "      {\n"
                + "        \"plan_id\": \"plan_id\"\n"
                + "      }\n"
                + "    ],\n"
                + "    \"plans\": [\n"
                + "      {\n"
                + "        \"charge_type\": \"charge_type\",\n"
                + "        \"company_count\": 1,\n"
                + "        \"compatible_plan_ids\": [\n"
                + "          \"compatible_plan_ids\"\n"
                + "        ],\n"
                + "        \"controlled_by\": \"controlled_by\",\n"
                + "        \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "        \"description\": \"description\",\n"
                + "        \"entitlements\": [\n"
                + "          {\n"
                + "            \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "            \"environment_id\": \"environment_id\",\n"
                + "            \"feature_id\": \"feature_id\",\n"
                + "            \"id\": \"id\",\n"
                + "            \"plan_id\": \"plan_id\",\n"
                + "            \"rule_id\": \"rule_id\",\n"
                + "            \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "            \"value_type\": \"value_type\"\n"
                + "          }\n"
                + "        ],\n"
                + "        \"features\": [\n"
                + "          {\n"
                + "            \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "            \"description\": \"description\",\n"
                + "            \"feature_type\": \"feature_type\",\n"
                + "            \"flags\": [\n"
                + "              {\n"
                + "                \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                \"default_value\": true,\n"
                + "                \"description\": \"description\",\n"
                + "                \"flag_type\": \"flag_type\",\n"
                + "                \"id\": \"id\",\n"
                + "                \"key\": \"key\",\n"
                + "                \"name\": \"name\",\n"
                + "                \"rules\": [\n"
                + "                  {\n"
                + "                    \"condition_groups\": [\n"
                + "                      {\n"
                + "                        \"conditions\": [\n"
                + "                          {\n"
                + "                            \"condition_type\": \"condition_type\",\n"
                + "                            \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                            \"environment_id\": \"environment_id\",\n"
                + "                            \"id\": \"id\",\n"
                + "                            \"operator\": \"operator\",\n"
                + "                            \"resource_ids\": [\n"
                + "                              \"resource_ids\"\n"
                + "                            ],\n"
                + "                            \"resources\": [\n"
                + "                              {\n"
                + "                                \"id\": \"id\",\n"
                + "                                \"name\": \"name\"\n"
                + "                              }\n"
                + "                            ],\n"
                + "                            \"rule_id\": \"rule_id\",\n"
                + "                            \"trait_value\": \"trait_value\",\n"
                + "                            \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                          }\n"
                + "                        ],\n"
                + "                        \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                        \"environment_id\": \"environment_id\",\n"
                + "                        \"id\": \"id\",\n"
                + "                        \"rule_id\": \"rule_id\",\n"
                + "                        \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                      }\n"
                + "                    ],\n"
                + "                    \"conditions\": [\n"
                + "                      {\n"
                + "                        \"condition_type\": \"condition_type\",\n"
                + "                        \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                        \"environment_id\": \"environment_id\",\n"
                + "                        \"id\": \"id\",\n"
                + "                        \"operator\": \"operator\",\n"
                + "                        \"resource_ids\": [\n"
                + "                          \"resource_ids\"\n"
                + "                        ],\n"
                + "                        \"resources\": [\n"
                + "                          {\n"
                + "                            \"id\": \"id\",\n"
                + "                            \"name\": \"name\"\n"
                + "                          }\n"
                + "                        ],\n"
                + "                        \"rule_id\": \"rule_id\",\n"
                + "                        \"trait_value\": \"trait_value\",\n"
                + "                        \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                      }\n"
                + "                    ],\n"
                + "                    \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                    \"environment_id\": \"environment_id\",\n"
                + "                    \"id\": \"id\",\n"
                + "                    \"name\": \"name\",\n"
                + "                    \"priority\": 1,\n"
                + "                    \"rule_type\": \"rule_type\",\n"
                + "                    \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                    \"value\": true\n"
                + "                  }\n"
                + "                ],\n"
                + "                \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "              }\n"
                + "            ],\n"
                + "            \"icon\": \"icon\",\n"
                + "            \"id\": \"id\",\n"
                + "            \"name\": \"name\",\n"
                + "            \"plans\": [\n"
                + "              {\n"
                + "                \"id\": \"id\",\n"
                + "                \"name\": \"name\"\n"
                + "              }\n"
                + "            ],\n"
                + "            \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "          }\n"
                + "        ],\n"
                + "        \"icon\": \"icon\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"is_custom\": true,\n"
                + "        \"is_default\": true,\n"
                + "        \"is_free\": true,\n"
                + "        \"is_trialable\": true,\n"
                + "        \"name\": \"name\",\n"
                + "        \"plan_type\": \"plan_type\",\n"
                + "        \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "      }\n"
                + "    ],\n"
                + "    \"prevent_downgrades_when_over_limit\": true,\n"
                + "    \"show_credits\": true,\n"
                + "    \"show_period_toggle\": true,\n"
                + "    \"show_zero_price_as_free\": true,\n"
                + "    \"sync_customer_billing_details_for_tax\": true,\n"
                + "    \"tax_collection_enabled\": true,\n"
                + "    \"trial_days\": 1,\n"
                + "    \"trial_expiry_plan\": {\n"
                + "      \"billing_product\": {\n"
                + "        \"account_id\": \"account_id\",\n"
                + "        \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "        \"environment_id\": \"environment_id\",\n"
                + "        \"external_id\": \"external_id\",\n"
                + "        \"is_active\": true,\n"
                + "        \"name\": \"name\",\n"
                + "        \"price\": 1.1,\n"
                + "        \"prices\": [\n"
                + "          {\n"
                + "            \"currency\": \"currency\",\n"
                + "            \"external_price_id\": \"external_price_id\",\n"
                + "            \"id\": \"id\",\n"
                + "            \"interval\": \"interval\",\n"
                + "            \"price\": 1,\n"
                + "            \"scheme\": \"scheme\"\n"
                + "          }\n"
                + "        ],\n"
                + "        \"product_id\": \"product_id\",\n"
                + "        \"quantity\": 1.1,\n"
                + "        \"subscription_count\": 1,\n"
                + "        \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "      },\n"
                + "      \"charge_type\": \"charge_type\",\n"
                + "      \"company_count\": 1,\n"
                + "      \"compatible_plan_ids\": [\n"
                + "        \"compatible_plan_ids\"\n"
                + "      ],\n"
                + "      \"controlled_by\": \"controlled_by\",\n"
                + "      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "      \"custom_plan_config\": {\n"
                + "        \"cta_text\": \"cta_text\",\n"
                + "        \"cta_web_site\": \"cta_web_site\",\n"
                + "        \"price_text\": \"price_text\"\n"
                + "      },\n"
                + "      \"description\": \"description\",\n"
                + "      \"entitlements\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"environment_id\": \"environment_id\",\n"
                + "          \"feature_id\": \"feature_id\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"plan_id\": \"plan_id\",\n"
                + "          \"rule_id\": \"rule_id\",\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"value_type\": \"value_type\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"features\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"description\": \"description\",\n"
                + "          \"feature_type\": \"feature_type\",\n"
                + "          \"flags\": [\n"
                + "            {\n"
                + "              \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "              \"default_value\": true,\n"
                + "              \"description\": \"description\",\n"
                + "              \"flag_type\": \"flag_type\",\n"
                + "              \"id\": \"id\",\n"
                + "              \"key\": \"key\",\n"
                + "              \"name\": \"name\",\n"
                + "              \"rules\": [\n"
                + "                {\n"
                + "                  \"condition_groups\": [\n"
                + "                    {\n"
                + "                      \"conditions\": [\n"
                + "                        {\n"
                + "                          \"condition_type\": \"condition_type\",\n"
                + "                          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                          \"environment_id\": \"environment_id\",\n"
                + "                          \"id\": \"id\",\n"
                + "                          \"operator\": \"operator\",\n"
                + "                          \"resource_ids\": [\n"
                + "                            \"resource_ids\"\n"
                + "                          ],\n"
                + "                          \"resources\": [\n"
                + "                            {\n"
                + "                              \"id\": \"id\",\n"
                + "                              \"name\": \"name\"\n"
                + "                            }\n"
                + "                          ],\n"
                + "                          \"rule_id\": \"rule_id\",\n"
                + "                          \"trait_value\": \"trait_value\",\n"
                + "                          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                        }\n"
                + "                      ],\n"
                + "                      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                      \"environment_id\": \"environment_id\",\n"
                + "                      \"id\": \"id\",\n"
                + "                      \"rule_id\": \"rule_id\",\n"
                + "                      \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                    }\n"
                + "                  ],\n"
                + "                  \"conditions\": [\n"
                + "                    {\n"
                + "                      \"condition_type\": \"condition_type\",\n"
                + "                      \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                      \"environment_id\": \"environment_id\",\n"
                + "                      \"id\": \"id\",\n"
                + "                      \"operator\": \"operator\",\n"
                + "                      \"resource_ids\": [\n"
                + "                        \"resource_ids\"\n"
                + "                      ],\n"
                + "                      \"resources\": [\n"
                + "                        {\n"
                + "                          \"id\": \"id\",\n"
                + "                          \"name\": \"name\"\n"
                + "                        }\n"
                + "                      ],\n"
                + "                      \"rule_id\": \"rule_id\",\n"
                + "                      \"trait_value\": \"trait_value\",\n"
                + "                      \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "                    }\n"
                + "                  ],\n"
                + "                  \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                  \"environment_id\": \"environment_id\",\n"
                + "                  \"id\": \"id\",\n"
                + "                  \"name\": \"name\",\n"
                + "                  \"priority\": 1,\n"
                + "                  \"rule_type\": \"rule_type\",\n"
                + "                  \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "                  \"value\": true\n"
                + "                }\n"
                + "              ],\n"
                + "              \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "            }\n"
                + "          ],\n"
                + "          \"icon\": \"icon\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"name\": \"name\",\n"
                + "          \"plans\": [\n"
                + "            {\n"
                + "              \"id\": \"id\",\n"
                + "              \"name\": \"name\"\n"
                + "            }\n"
                + "          ],\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"icon\": \"icon\",\n"
                + "      \"id\": \"id\",\n"
                + "      \"included_credit_grants\": [\n"
                + "        {\n"
                + "          \"created_at\": \"2024-01-15T09:30:00Z\",\n"
                + "          \"credit_amount\": 1,\n"
                + "          \"credit_id\": \"credit_id\",\n"
                + "          \"credit_name\": \"credit_name\",\n"
                + "          \"id\": \"id\",\n"
                + "          \"plan_id\": \"plan_id\",\n"
                + "          \"plan_name\": \"plan_name\",\n"
                + "          \"reset_cadence\": \"reset_cadence\",\n"
                + "          \"reset_start\": \"reset_start\",\n"
                + "          \"updated_at\": \"2024-01-15T09:30:00Z\"\n"
                + "        }\n"
                + "      ],\n"
                + "      \"is_custom\": true,\n"
                + "      \"is_default\": true,\n"
                + "      \"is_free\": true,\n"
                + "      \"is_trialable\": true,\n"
                + "      \"monthly_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      },\n"
                + "      \"name\": \"name\",\n"
                + "      \"one_time_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      },\n"
                + "      \"plan_type\": \"plan_type\",\n"
                + "      \"trial_days\": 1,\n"
                + "      \"updated_at\": \"2024-01-15T09:30:00Z\",\n"
                + "      \"yearly_price\": {\n"
                + "        \"currency\": \"currency\",\n"
                + "        \"external_price_id\": \"external_price_id\",\n"
                + "        \"id\": \"id\",\n"
                + "        \"interval\": \"interval\",\n"
                + "        \"price\": 1,\n"
                + "        \"scheme\": \"scheme\"\n"
                + "      }\n"
                + "    },\n"
                + "    \"trial_expiry_plan_id\": \"trial_expiry_plan_id\",\n"
                + "    \"trial_expiry_plan_price\": {\n"
                + "      \"currency\": \"currency\",\n"
                + "      \"external_price_id\": \"external_price_id\",\n"
                + "      \"id\": \"id\",\n"
                + "      \"interval\": \"interval\",\n"
                + "      \"price\": 1,\n"
                + "      \"price_decimal\": \"price_decimal\",\n"
                + "      \"scheme\": \"scheme\"\n"
                + "    },\n"
                + "    \"trial_expiry_plan_price_id\": \"trial_expiry_plan_price_id\",\n"
                + "    \"trial_payment_method_required\": true\n"
                + "  },\n"
                + "  \"params\": {\n"
                + "    \"key\": \"value\"\n"
                + "  }\n"
                + "}";
        JsonNode actualResponseNode = objectMapper.readTree(actualResponseJson);
        JsonNode expectedResponseNode = objectMapper.readTree(expectedResponseBody);
        Assertions.assertEquals(
                expectedResponseNode, actualResponseNode, "Response body structure does not match expected");
        if (actualResponseNode.has("type") || actualResponseNode.has("_type") || actualResponseNode.has("kind")) {
            String discriminator = null;
            if (actualResponseNode.has("type"))
                discriminator = actualResponseNode.get("type").asText();
            else if (actualResponseNode.has("_type"))
                discriminator = actualResponseNode.get("_type").asText();
            else if (actualResponseNode.has("kind"))
                discriminator = actualResponseNode.get("kind").asText();
            Assertions.assertNotNull(discriminator, "Union type should have a discriminator field");
            Assertions.assertFalse(discriminator.isEmpty(), "Union discriminator should not be empty");
        }

        if (!actualResponseNode.isNull()) {
            Assertions.assertTrue(
                    actualResponseNode.isObject() || actualResponseNode.isArray() || actualResponseNode.isValueNode(),
                    "response should be a valid JSON value");
        }

        if (actualResponseNode.isArray()) {
            Assertions.assertTrue(actualResponseNode.size() >= 0, "Array should have valid size");
        }
        if (actualResponseNode.isObject()) {
            Assertions.assertTrue(actualResponseNode.size() >= 0, "Object should have valid field count");
        }
    }

    @Test
    public void testCreatePlanGroup() throws Exception {
        server.enqueue(
                new MockResponse()
                        .setResponseCode(200)
                        .setBody(
                                "{\"data\":{\"add_on_compatibilities\":[{\"compatible_plan_ids\":[\"compatible_plan_ids\"],\"source_plan_id\":\"source_plan_id\"}],\"add_on_ids\":[\"add_on_ids\"],\"checkout_settings\":{\"collect_address\":true,\"collect_email\":true,\"collect_phone\":true},\"fallback_plan_id\":\"fallback_plan_id\",\"id\":\"id\",\"initial_plan_id\":\"initial_plan_id\",\"initial_plan_price_id\":\"initial_plan_price_id\",\"ordered_add_on_ids\":[{\"plan_id\":\"plan_id\"}],\"plan_ids\":[{\"plan_id\":\"plan_id\"}],\"prevent_downgrades_when_over_limit\":true,\"show_credits\":true,\"show_period_toggle\":true,\"show_zero_price_as_free\":true,\"sync_customer_billing_details_for_tax\":true,\"tax_collection_enabled\":true,\"trial_days\":1,\"trial_expiry_plan_id\":\"trial_expiry_plan_id\",\"trial_expiry_plan_price_id\":\"trial_expiry_plan_price_id\",\"trial_payment_method_required\":true},\"params\":{\"key\":\"value\"}}"));
        CreatePlanGroupResponse response = client.plangroups()
                .createPlanGroup(CreatePlanGroupRequestBody.builder()
                        .addOnIds(Arrays.asList("add_on_ids"))
                        .checkoutCollectAddress(true)
                        .checkoutCollectEmail(true)
                        .checkoutCollectPhone(true)
                        .enableTaxCollection(true)
                        .orderedAddOns(Arrays.asList(
                                OrderedPlansInGroup.builder().planId("plan_id").build()))
                        .orderedBundleList(Arrays.asList(PlanGroupBundleOrder.builder()
                                .bundleId("bundleId")
                                .build()))
                        .orderedPlans(Arrays.asList(
                                OrderedPlansInGroup.builder().planId("plan_id").build()))
                        .preventDowngradesWhenOverLimit(true)
                        .showCredits(true)
                        .showPeriodToggle(true)
                        .showZeroPriceAsFree(true)
                        .syncCustomerBillingDetailsForTax(true)
                        .build());
        RecordedRequest request = server.takeRequest();
        Assertions.assertNotNull(request);
        Assertions.assertEquals("POST", request.getMethod());
        // Validate request body
        String actualRequestBody = request.getBody().readUtf8();
        String expectedRequestBody = ""
                + "{\n"
                + "  \"add_on_ids\": [\n"
                + "    \"add_on_ids\"\n"
                + "  ],\n"
                + "  \"checkout_collect_address\": true,\n"
                + "  \"checkout_collect_email\": true,\n"
                + "  \"checkout_collect_phone\": true,\n"
                + "  \"enable_tax_collection\": true,\n"
                + "  \"ordered_add_ons\": [\n"
                + "    {\n"
                + "      \"plan_id\": \"plan_id\"\n"
                + "    }\n"
                + "  ],\n"
                + "  \"ordered_bundle_list\": [\n"
                + "    {\n"
                + "      \"bundleId\": \"bundleId\"\n"
                + "    }\n"
                + "  ],\n"
                + "  \"ordered_plans\": [\n"
                + "    {\n"
                + "      \"plan_id\": \"plan_id\"\n"
                + "    }\n"
                + "  ],\n"
                + "  \"prevent_downgrades_when_over_limit\": true,\n"
                + "  \"show_credits\": true,\n"
                + "  \"show_period_toggle\": true,\n"
                + "  \"show_zero_price_as_free\": true,\n"
                + "  \"sync_customer_billing_details_for_tax\": true\n"
                + "}";
        JsonNode actualJson = objectMapper.readTree(actualRequestBody);
        JsonNode expectedJson = objectMapper.readTree(expectedRequestBody);
        Assertions.assertEquals(expectedJson, actualJson, "Request body structure does not match expected");
        if (actualJson.has("type") || actualJson.has("_type") || actualJson.has("kind")) {
            String discriminator = null;
            if (actualJson.has("type")) discriminator = actualJson.get("type").asText();
            else if (actualJson.has("_type"))
                discriminator = actualJson.get("_type").asText();
            else if (actualJson.has("kind"))
                discriminator = actualJson.get("kind").asText();
            Assertions.assertNotNull(discriminator, "Union type should have a discriminator field");
            Assertions.assertFalse(discriminator.isEmpty(), "Union discriminator should not be empty");
        }

        if (!actualJson.isNull()) {
            Assertions.assertTrue(
                    actualJson.isObject() || actualJson.isArray() || actualJson.isValueNode(),
                    "request should be a valid JSON value");
        }

        if (actualJson.isArray()) {
            Assertions.assertTrue(actualJson.size() >= 0, "Array should have valid size");
        }
        if (actualJson.isObject()) {
            Assertions.assertTrue(actualJson.size() >= 0, "Object should have valid field count");
        }

        // Validate response body
        Assertions.assertNotNull(response, "Response should not be null");
        String actualResponseJson = objectMapper.writeValueAsString(response);
        String expectedResponseBody = ""
                + "{\n"
                + "  \"data\": {\n"
                + "    \"add_on_compatibilities\": [\n"
                + "      {\n"
                + "        \"compatible_plan_ids\": [\n"
                + "          \"compatible_plan_ids\"\n"
                + "        ],\n"
                + "        \"source_plan_id\": \"source_plan_id\"\n"
                + "      }\n"
                + "    ],\n"
                + "    \"add_on_ids\": [\n"
                + "      \"add_on_ids\"\n"
                + "    ],\n"
                + "    \"checkout_settings\": {\n"
                + "      \"collect_address\": true,\n"
                + "      \"collect_email\": true,\n"
                + "      \"collect_phone\": true\n"
                + "    },\n"
                + "    \"fallback_plan_id\": \"fallback_plan_id\",\n"
                + "    \"id\": \"id\",\n"
                + "    \"initial_plan_id\": \"initial_plan_id\",\n"
                + "    \"initial_plan_price_id\": \"initial_plan_price_id\",\n"
                + "    \"ordered_add_on_ids\": [\n"
                + "      {\n"
                + "        \"plan_id\": \"plan_id\"\n"
                + "      }\n"
                + "    ],\n"
                + "    \"plan_ids\": [\n"
                + "      {\n"
                + "        \"plan_id\": \"plan_id\"\n"
                + "      }\n"
                + "    ],\n"
                + "    \"prevent_downgrades_when_over_limit\": true,\n"
                + "    \"show_credits\": true,\n"
                + "    \"show_period_toggle\": true,\n"
                + "    \"show_zero_price_as_free\": true,\n"
                + "    \"sync_customer_billing_details_for_tax\": true,\n"
                + "    \"tax_collection_enabled\": true,\n"
                + "    \"trial_days\": 1,\n"
                + "    \"trial_expiry_plan_id\": \"trial_expiry_plan_id\",\n"
                + "    \"trial_expiry_plan_price_id\": \"trial_expiry_plan_price_id\",\n"
                + "    \"trial_payment_method_required\": true\n"
                + "  },\n"
                + "  \"params\": {\n"
                + "    \"key\": \"value\"\n"
                + "  }\n"
                + "}";
        JsonNode actualResponseNode = objectMapper.readTree(actualResponseJson);
        JsonNode expectedResponseNode = objectMapper.readTree(expectedResponseBody);
        Assertions.assertEquals(
                expectedResponseNode, actualResponseNode, "Response body structure does not match expected");
        if (actualResponseNode.has("type") || actualResponseNode.has("_type") || actualResponseNode.has("kind")) {
            String discriminator = null;
            if (actualResponseNode.has("type"))
                discriminator = actualResponseNode.get("type").asText();
            else if (actualResponseNode.has("_type"))
                discriminator = actualResponseNode.get("_type").asText();
            else if (actualResponseNode.has("kind"))
                discriminator = actualResponseNode.get("kind").asText();
            Assertions.assertNotNull(discriminator, "Union type should have a discriminator field");
            Assertions.assertFalse(discriminator.isEmpty(), "Union discriminator should not be empty");
        }

        if (!actualResponseNode.isNull()) {
            Assertions.assertTrue(
                    actualResponseNode.isObject() || actualResponseNode.isArray() || actualResponseNode.isValueNode(),
                    "response should be a valid JSON value");
        }

        if (actualResponseNode.isArray()) {
            Assertions.assertTrue(actualResponseNode.size() >= 0, "Array should have valid size");
        }
        if (actualResponseNode.isObject()) {
            Assertions.assertTrue(actualResponseNode.size() >= 0, "Object should have valid field count");
        }
    }

    @Test
    public void testUpdatePlanGroup() throws Exception {
        server.enqueue(
                new MockResponse()
                        .setResponseCode(200)
                        .setBody(
                                "{\"data\":{\"add_on_compatibilities\":[{\"compatible_plan_ids\":[\"compatible_plan_ids\"],\"source_plan_id\":\"source_plan_id\"}],\"add_on_ids\":[\"add_on_ids\"],\"checkout_settings\":{\"collect_address\":true,\"collect_email\":true,\"collect_phone\":true},\"fallback_plan_id\":\"fallback_plan_id\",\"id\":\"id\",\"initial_plan_id\":\"initial_plan_id\",\"initial_plan_price_id\":\"initial_plan_price_id\",\"ordered_add_on_ids\":[{\"plan_id\":\"plan_id\"}],\"plan_ids\":[{\"plan_id\":\"plan_id\"}],\"prevent_downgrades_when_over_limit\":true,\"show_credits\":true,\"show_period_toggle\":true,\"show_zero_price_as_free\":true,\"sync_customer_billing_details_for_tax\":true,\"tax_collection_enabled\":true,\"trial_days\":1,\"trial_expiry_plan_id\":\"trial_expiry_plan_id\",\"trial_expiry_plan_price_id\":\"trial_expiry_plan_price_id\",\"trial_payment_method_required\":true},\"params\":{\"key\":\"value\"}}"));
        UpdatePlanGroupResponse response = client.plangroups()
                .updatePlanGroup(
                        "plan_group_id",
                        UpdatePlanGroupRequestBody.builder()
                                .addOnIds(Arrays.asList("add_on_ids"))
                                .checkoutCollectAddress(true)
                                .checkoutCollectEmail(true)
                                .checkoutCollectPhone(true)
                                .enableTaxCollection(true)
                                .orderedAddOns(Arrays.asList(OrderedPlansInGroup.builder()
                                        .planId("plan_id")
                                        .build()))
                                .orderedBundleList(Arrays.asList(PlanGroupBundleOrder.builder()
                                        .bundleId("bundleId")
                                        .build()))
                                .orderedPlans(Arrays.asList(OrderedPlansInGroup.builder()
                                        .planId("plan_id")
                                        .build()))
                                .preventDowngradesWhenOverLimit(true)
                                .showCredits(true)
                                .showPeriodToggle(true)
                                .showZeroPriceAsFree(true)
                                .syncCustomerBillingDetailsForTax(true)
                                .build());
        RecordedRequest request = server.takeRequest();
        Assertions.assertNotNull(request);
        Assertions.assertEquals("PUT", request.getMethod());
        // Validate request body
        String actualRequestBody = request.getBody().readUtf8();
        String expectedRequestBody = ""
                + "{\n"
                + "  \"add_on_ids\": [\n"
                + "    \"add_on_ids\"\n"
                + "  ],\n"
                + "  \"checkout_collect_address\": true,\n"
                + "  \"checkout_collect_email\": true,\n"
                + "  \"checkout_collect_phone\": true,\n"
                + "  \"enable_tax_collection\": true,\n"
                + "  \"ordered_add_ons\": [\n"
                + "    {\n"
                + "      \"plan_id\": \"plan_id\"\n"
                + "    }\n"
                + "  ],\n"
                + "  \"ordered_bundle_list\": [\n"
                + "    {\n"
                + "      \"bundleId\": \"bundleId\"\n"
                + "    }\n"
                + "  ],\n"
                + "  \"ordered_plans\": [\n"
                + "    {\n"
                + "      \"plan_id\": \"plan_id\"\n"
                + "    }\n"
                + "  ],\n"
                + "  \"prevent_downgrades_when_over_limit\": true,\n"
                + "  \"show_credits\": true,\n"
                + "  \"show_period_toggle\": true,\n"
                + "  \"show_zero_price_as_free\": true,\n"
                + "  \"sync_customer_billing_details_for_tax\": true\n"
                + "}";
        JsonNode actualJson = objectMapper.readTree(actualRequestBody);
        JsonNode expectedJson = objectMapper.readTree(expectedRequestBody);
        Assertions.assertEquals(expectedJson, actualJson, "Request body structure does not match expected");
        if (actualJson.has("type") || actualJson.has("_type") || actualJson.has("kind")) {
            String discriminator = null;
            if (actualJson.has("type")) discriminator = actualJson.get("type").asText();
            else if (actualJson.has("_type"))
                discriminator = actualJson.get("_type").asText();
            else if (actualJson.has("kind"))
                discriminator = actualJson.get("kind").asText();
            Assertions.assertNotNull(discriminator, "Union type should have a discriminator field");
            Assertions.assertFalse(discriminator.isEmpty(), "Union discriminator should not be empty");
        }

        if (!actualJson.isNull()) {
            Assertions.assertTrue(
                    actualJson.isObject() || actualJson.isArray() || actualJson.isValueNode(),
                    "request should be a valid JSON value");
        }

        if (actualJson.isArray()) {
            Assertions.assertTrue(actualJson.size() >= 0, "Array should have valid size");
        }
        if (actualJson.isObject()) {
            Assertions.assertTrue(actualJson.size() >= 0, "Object should have valid field count");
        }

        // Validate response body
        Assertions.assertNotNull(response, "Response should not be null");
        String actualResponseJson = objectMapper.writeValueAsString(response);
        String expectedResponseBody = ""
                + "{\n"
                + "  \"data\": {\n"
                + "    \"add_on_compatibilities\": [\n"
                + "      {\n"
                + "        \"compatible_plan_ids\": [\n"
                + "          \"compatible_plan_ids\"\n"
                + "        ],\n"
                + "        \"source_plan_id\": \"source_plan_id\"\n"
                + "      }\n"
                + "    ],\n"
                + "    \"add_on_ids\": [\n"
                + "      \"add_on_ids\"\n"
                + "    ],\n"
                + "    \"checkout_settings\": {\n"
                + "      \"collect_address\": true,\n"
                + "      \"collect_email\": true,\n"
                + "      \"collect_phone\": true\n"
                + "    },\n"
                + "    \"fallback_plan_id\": \"fallback_plan_id\",\n"
                + "    \"id\": \"id\",\n"
                + "    \"initial_plan_id\": \"initial_plan_id\",\n"
                + "    \"initial_plan_price_id\": \"initial_plan_price_id\",\n"
                + "    \"ordered_add_on_ids\": [\n"
                + "      {\n"
                + "        \"plan_id\": \"plan_id\"\n"
                + "      }\n"
                + "    ],\n"
                + "    \"plan_ids\": [\n"
                + "      {\n"
                + "        \"plan_id\": \"plan_id\"\n"
                + "      }\n"
                + "    ],\n"
                + "    \"prevent_downgrades_when_over_limit\": true,\n"
                + "    \"show_credits\": true,\n"
                + "    \"show_period_toggle\": true,\n"
                + "    \"show_zero_price_as_free\": true,\n"
                + "    \"sync_customer_billing_details_for_tax\": true,\n"
                + "    \"tax_collection_enabled\": true,\n"
                + "    \"trial_days\": 1,\n"
                + "    \"trial_expiry_plan_id\": \"trial_expiry_plan_id\",\n"
                + "    \"trial_expiry_plan_price_id\": \"trial_expiry_plan_price_id\",\n"
                + "    \"trial_payment_method_required\": true\n"
                + "  },\n"
                + "  \"params\": {\n"
                + "    \"key\": \"value\"\n"
                + "  }\n"
                + "}";
        JsonNode actualResponseNode = objectMapper.readTree(actualResponseJson);
        JsonNode expectedResponseNode = objectMapper.readTree(expectedResponseBody);
        Assertions.assertEquals(
                expectedResponseNode, actualResponseNode, "Response body structure does not match expected");
        if (actualResponseNode.has("type") || actualResponseNode.has("_type") || actualResponseNode.has("kind")) {
            String discriminator = null;
            if (actualResponseNode.has("type"))
                discriminator = actualResponseNode.get("type").asText();
            else if (actualResponseNode.has("_type"))
                discriminator = actualResponseNode.get("_type").asText();
            else if (actualResponseNode.has("kind"))
                discriminator = actualResponseNode.get("kind").asText();
            Assertions.assertNotNull(discriminator, "Union type should have a discriminator field");
            Assertions.assertFalse(discriminator.isEmpty(), "Union discriminator should not be empty");
        }

        if (!actualResponseNode.isNull()) {
            Assertions.assertTrue(
                    actualResponseNode.isObject() || actualResponseNode.isArray() || actualResponseNode.isValueNode(),
                    "response should be a valid JSON value");
        }

        if (actualResponseNode.isArray()) {
            Assertions.assertTrue(actualResponseNode.size() >= 0, "Array should have valid size");
        }
        if (actualResponseNode.isObject()) {
            Assertions.assertTrue(actualResponseNode.size() >= 0, "Object should have valid field count");
        }
    }
}
